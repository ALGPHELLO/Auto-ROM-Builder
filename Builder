# Fix build
sudo dpkg --configure -a
sudo apt install -f
sudo apt-get autoremove
# Install build tools
sudo apt-get install -y git-core gnupg flex bison gperf build-essential 
  zip curl zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 
  lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev ccache 
  libgl1-mesa-dev libxml2-utils xsltproc unzip maven schedtool
# Install Java
sudo add-apt-repository -y ppa:openjdk-r/ppa && sudo apt-get update && sudo apt-get install openjdk-7-jdk
# Install repo
curl http://commondatastorage.googleapis.com/git-repo-downloads/repo > ~/bin/repo && chmod a+x ~/bin/repo
echo "export USE_CCACHE=1" >> ~/.bashrc
echo "export PATH=~/bin:$PATH" >> ~/.bashrc
source ~/.bashrc
# Perpairing source
mkdir ~/android && cd ~/android
git config --global user.email "ysh-alsager.com"
git config --global user.name "yshalsager"
git config --global color.ui false
# ROM Repo
repo init -u git://github.com/SlimRoms/platform_manifest.git -b kk4.4
# Local Manifests
curl -L -o .repo/local_manifests/normandykk.xml -O -L https://github.com/yshalsager/CircleCI-ROM-Builder/raw/master/normandykk.xml
repo sync -c -j4 >log 2>&1
# Edit device tree
cd ~/android/device/nokia/xl && mv cm.mk slim.mk && rm cm.mk
cd patches && chmod 775 apply.sh && ./apply.sh
cd ~/android
. build/envsetup.sh
brunch xl
